!function(){"use strict";class t{constructor(t,{setScore:s,setMaxScore:i,clearTimer:h}){this.ctx=t,this.flag=[],this.cx=60,this.cy=240,this.arrX=[],this.arrY=[],this.snake_len=2,this.fps=6,this.score=0,this.count=0,this.arrScore=[],this.maxScore=0,this.setScore=s,this.setMaxScore=i,this.clearTimer=h;for(let t=0,s=this.snake_len;t<s;t++)this.arrX.push(60),this.arrY.push(260-10*t);for(this.coord(),this.drawSnake(this.cx,this.cy,2),this.coordLabel(this.cx,this.cy,this.arrX,this.arrY),this.ax=Math.floor(270*Math.random()+10),this.ay=Math.floor(270*Math.random()+10);1===this.flag[this.ax][this.ay];)this.ax=Math.floor(270*Math.random()+10),this.ay=Math.floor(270*Math.random()+10);this.drawApple(this.ax,this.ay)}circle(t,s,i,h){t.save(),t.beginPath(),t.arc(s.rx,s.ry,s.r,s.start,s.end,s.dir),t.fillStyle=h||"#fff",t.strokeStyle=i||"#666",t.fill(),t.stroke(),t.closePath(),t.restore()}coord(){this.ctx.beginPath();for(let t=0;t<31;t++)this.ctx.moveTo(0,10*t),this.ctx.lineTo(300,10*t),this.ctx.strokeStyle="#333";this.ctx.stroke(),this.ctx.beginPath();for(let t=0;t<31;t++)this.ctx.moveTo(10*t,0),this.ctx.lineTo(10*t,300),this.ctx.strokeStyle="#333";this.ctx.stroke()}coordLabel(t,s,i,h){for(let t=0;t<300;t++){this.flag[t]=[];for(let s=0;s<300;s++)this.flag[t][s]=0}this.flag[t][s]=-1;for(let t=0,s=i.length;t<s;t++)this.flag[+i[t]][+h[t]]=1}isStop(t,s){let i=!1;return(t>=297||s>=297||t<=3||s<=3)&&(i=!0),i}drawSnake(t,s,i){this.circle(this.ctx,{rx:t,ry:s,r:5,start:0,end:2*Math.PI},"#333","#26f");for(let t=i-1;t>=0;t--)this.circle(this.ctx,{rx:this.arrX[t],ry:this.arrY[t],r:5,start:0,end:2*Math.PI},"#333","#0c3")}drawApple(t,s){this.circle(this.ctx,{rx:t,ry:s,r:5,start:0,end:2*Math.PI},"#333","#f20")}moveByDir(t){({L:()=>{this.cx=this.cx-10,this.cy=this.cy},T:()=>{this.cx=this.cx,this.cy=this.cy-10},R:()=>{this.cx=this.cx+10,this.cy=this.cy},D:()=>{this.cx=this.cx,this.cy=this.cy+10}})[t]()}initFunc(){this.cx=60,this.cy=240,this.fps=6,this.snake_len=2,this.arrX=[],this.arrY=[];for(let t=0,s=this.snake_len;t<s;t++)this.arrX.push(60),this.arrY.push(260-10*t);this.score=0,this.count=0,this.setScore(this.score),this.ctx.clearRect(0,0,300,300),this.coord(),this.drawSnake(this.cx,this.cy,this.snake_len),this.drawApple(this.ax,this.ay)}changeToDir(t){if(this.ctx.clearRect(0,0,300,300),this.coord(),this.drawApple(this.ax,this.ay),this.isStop(this.cx,this.cy))return this.clearTimer(),alert("Game Over!!!"),void this.initFunc();if(this.drawSnake(this.cx,this.cy,this.snake_len),this.arrX.push(this.cx),this.arrX.shift(),this.arrY.push(this.cy),this.arrY.shift(),this.moveByDir(t),Math.abs(this.cx-this.ax)<=7&&Math.abs(this.cy-this.ay)<=7){if(this.count++,this.score=100*this.count,this.arrScore.push(this.score),this.maxScore=Math.max.apply(null,this.arrScore),this.setScore(this.score),this.setMaxScore(this.maxScore),this.count%5==0)for(this.fps=this.fps+1,this.ax=Math.floor(20*Math.random())+260,this.ay=Math.floor(20*Math.random())+260;1===this.flag[this.ax][this.ay];)this.ax=Math.floor(20*Math.random())+260,this.ay=Math.floor(20*Math.random())+260;else for(this.ax=Math.floor(270*Math.random()+10),this.ay=Math.floor(270*Math.random()+10);1===this.flag[this.ax][this.ay];)this.ax=Math.floor(270*Math.random()+10),this.ay=Math.floor(270*Math.random()+10);this.drawApple(this.ax,this.ay),this.snake_len+=1,this.arrX.push(this.cx),this.arrY.push(this.cy)}this.coordLabel(this.cx,this.cy,this.arrX,this.arrY);for(let t=0,s=this.arrX.length-1;t<s;t++)this.cx===this.arrX[t]&&this.cy===this.arrY[t]&&(this.clearTimer(),alert("蛇撞到自己了"),this.initFunc())}}window.addEventListener("DOMContentLoaded",function(s){let i=document.getElementById("canvas"),h=i.getContext("2d"),r=document.getElementById("reset"),e=document.getElementById("get_score"),a=document.getElementById("max_score");i.width=300,i.height=300;let c=null,o=new t(h,{setScore:t=>{e.innerHTML=t+"分"},setMaxScore:t=>{a.innerHTML=t+"分"},clearTimer:()=>{clearInterval(c)}});e.innerHTML=o.score+"分",a.innerHTML=o.maxScore+"分",document.addEventListener("keydown",function(t){37===t.keyCode&&(clearInterval(c),c=setInterval(function(){o.changeToDir("L")},1e3/o.fps)),38===t.keyCode&&(clearInterval(c),c=setInterval(function(){o.changeToDir("T")},1e3/o.fps)),39===t.keyCode&&(clearInterval(c),c=setInterval(function(){o.changeToDir("R")},1e3/o.fps)),40===t.keyCode&&(clearInterval(c),c=setInterval(function(){o.changeToDir("D")},1e3/o.fps))}),r.onclick=function(){clearInterval(c),alert("Ready Go!!!"),o.initFunc(),o.maxScore=0,o.arrScore=[],a.innerHTML=o.maxScore+"分"}},!1)}();
//# sourceMappingURL=snake.min.js.map
